# UltraLights server configuration

# ---------------------------------------------------------------------------
# Web server
# ---------------------------------------------------------------------------
WEB_HOST=0.0.0.0
WEB_PORT=8000
PUBLIC_BASE=https://lights.evm100.org
LAN_PUBLIC_BASE=https://192.168.1.101

# TLS certificates (set only when TLS termination happens here)
SSL_CERTFILE=/etc/letsencrypt/live/lights.evm100.com/fullchain.pem
SSL_KEYFILE=/etc/letsencrypt/live/lights.evm100.com/privkey.pem

# ESP-IDF toolchain
# Path to export.sh (or export.ps1 on Windows) so the firmware builder picks up
# the correct idf.py environment. Leave empty to skip automatic sourcing.
ESP_IDF_EXPORT_SCRIPT=

# ---------------------------------------------------------------------------
# MQTT broker
# ---------------------------------------------------------------------------
# Hostname used for TLS validation (should match the certificate).
BROKER_HOST=lights.evm100.org
# Optionally override the network address we dial (e.g. local IP or tunnel).
BROKER_CONNECT_HOST=127.0.0.1
BROKER_PORT=8883
BROKER_USERNAME=uluser
BROKER_PASSWORD=ulpwd
BROKER_TLS_ENABLED=1
BROKER_TLS_INSECURE=0
# Leave BROKER_TLS_CA_FILE empty to use system trust store (e.g. for Let's Encrypt).
# Set to a custom CA bundle when using self-signed certificates.
BROKER_TLS_CA_FILE=
# Override the TLS server name presented during the handshake.
BROKER_TLS_SERVERNAME=
# Pin the negotiated TLS version while migrating the broker. Valid values: 1.2, 1.3.
BROKER_TLS_VERSION=1.2
# Optionally limit allowed cipher suites (OpenSSL syntax); leave blank for defaults.
BROKER_TLS_CIPHERS=
EMBED_BROKER=0

# ---------------------------------------------------------------------------
# Firmware updates & API security
# ---------------------------------------------------------------------------
FIRMWARE_DIR=/srv/firmware/UltraLights
API_BEARER=replace-with-long-random-bearer
MANIFEST_HMAC_SECRET=replace-with-64-char-hex-key

# ---------------------------------------------------------------------------
# Authentication, sessions & limits
# ---------------------------------------------------------------------------
DATA_DIR=/srv/ultralights
AUTH_DB_URL=sqlite:////srv/ultralights/auth.sqlite3
SESSION_SECRET=replace-with-long-random-string
INITIAL_ADMIN_USERNAME=
INITIAL_ADMIN_PASSWORD=
MAX_HOUSE_ID_LENGTH=64
LOGIN_ATTEMPT_LIMIT=5
LOGIN_ATTEMPT_WINDOW=300
LOGIN_BACKOFF_SECONDS=900

# ---------------------------------------------------------------------------
# Optional compatibility topics for legacy firmware
# ---------------------------------------------------------------------------
MQTT_COMPAT_PUBLISH_BOTH=1
LEGACY_TOPIC_COLOR=strip/cmd/color
LEGACY_TOPIC_EFFECT=strip/cmd/effect
LEGACY_TOPIC_SPACEY=strip/cmd/spacey
LEGACY_TOPIC_OTA=strip/cmd/ota

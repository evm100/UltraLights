<section class="glass rounded-2xl p-6">
  <h3 class="text-lg font-semibold mb-3">Brightness</h3>
  <div class="flex items-center gap-4">
    <input id="br" type="range" min="0" max="255" value="128" class="w-full">
    <span id="brv" class="w-12 text-right opacity-80">128</span>
  </div>
  <div class="mt-4 flex gap-2">
    <button id="off" class="px-4 py-2 pill bg-rose-600 hover:bg-rose-500">Off</button>
    <button id="on" class="px-4 py-2 pill bg-emerald-600 hover:bg-emerald-500">On</button>
  </div>
</section>
<script>
const br=document.getElementById('br');const brv=document.getElementById('brv');
const nodeApiId={{ (api_node_id or node.id)|tojson }};
br.addEventListener('input',()=>{brv.textContent=br.value;});
async function post(path,body){const res=await fetch(path,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});if(!res.ok){alert('Request failed');}}
br.addEventListener('change',async()=>{await post(`/api/node/${nodeApiId}/brightness`,{level:parseInt(br.value)});});
document.getElementById('off').onclick=async()=>{br.value=0;brv.textContent='0';await post(`/api/node/${nodeApiId}/brightness`,{level:0});};
document.getElementById('on').onclick=async()=>{br.value=255;brv.textContent='255';await post(`/api/node/${nodeApiId}/brightness`,{level:255});};
</script>
